"use strict";async function loadIP(e=""){try{let t=`https://ipapi.co/${e}/${ipField}/`,r=await fetch(t);if(!r.ok)throw`Looks like there was a problem. Status Code: ${r.status}`;let a=await r.json(),n=checkError(a);treatment(firstTreatment(n))}catch(e){let t=document.createElement("span");console.error(e),t.classList.add("error","message--blink"),t.textContent=e,block.innerHTML="",block.append(t),setTimeout(blink,500,3,t)}}function checkError(e){if(e.error){switch(e.reserved){case!0:e.reason="Зарезервированный IP-адрес";break;default:e.reason="Неверный IP-адрес"}return{ip:e.ip,error:e.error,reason:e.reason}}for(let t in e)null!==e[t]&&void 0!==e[t]||delete e[t];return e}function firstTreatment(e){return e.error?delete e.error:(e.country_name&&e.country_code&&(e.country=e.country_name+" | "+e.country_code),e.latitude&&e.longitude&&(e.latitude=e.latitude+", "+e.longitude),e.timezone&&e.utc_offset&&(e.timezone=e.timezone+` (${e.utc_offset})`),delete e.country_code,delete e.country_name,delete e.longitude,delete e.utc_offset),e}function treatment(e){let{ip:t}=e,r=Object.entries(e);inputAddress.placeholder=t,r.forEach(([e,t])=>blockFragment.append(rowCreate(e,t))),block.innerHTML="",block.append(blockFragment)}function rowCreate(e,t){let r=document.createElement("div");return r.classList.add("ipaddress__row"),r.insertAdjacentHTML("beforeend",`<span class="ipaddress__item ipaddress__item--title">${translater(e)} </span><span class="ipaddress__item ipaddress__item--text">${t}</span>`),r}function translater(e){let t;switch(e){case"ip":t="Адрес";break;case"version":t="Протокол";break;case"city":t="Город";break;case"region":t="Область";break;case"region_code":t="Код области";break;case"country":t="Страна";break;case"latitude":t="Координаты";break;case"country_name":t="Страна";break;case"country_code":t="Код страны";break;case"country_code_iso3":t="Код ISO3";break;case"country_capital":t="Столица";break;case"country_tld":t="Домен";break;case"continent_code":t="Код континента";break;case"in_eu":t="Вхождение в ЕС";break;case"postal":t="Почтовый индекс";break;case"timezone":t="Часовой пояс";break;case"country_calling_code":t="Мобильный код";break;case"currency":t="Код валюты";break;case"currency_name":t="Валюта";break;case"languages":t="Язык";break;case"country_area":t="Площадь страны";break;case"country_population":t="Количество населения";break;case"asn":t="ASN";break;case"org":t="Провайдер";break;case"reason":t="Ошибка"}return t}function copyCell(e){navigator.clipboard?navigator.clipboard.writeText(e.textContent).catch(e=>console.error(e)):window.getSelection()?(document.getSelection().selectAllChildren(e),document.execCommand("copy"),document.getSelection().empty()):document.body.createTextRange&&(range=document.body.createTextRange(),range.moveToElementText(e),range.select(),document.execCommand("copy")),document.getSelection().selectAllChildren(e)}function blink(e,t){t.classList.toggle("message--blink");let r=setTimeout(blink,500,++e,t);8===e&&clearTimeout(r)}function reloadIP(){/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/.test(inputAddress.value)||(inputAddress.value=""),loadIP(inputAddress.value),inputAddress.blur()}let block=document.querySelector(".ipaddress__info"),blockFragment=new DocumentFragment,inputForm=document.forms.ipaddress,inputAddress=inputForm.address,inputButton=inputForm.button,ipInfo=document.getElementsByClassName("ipaddress__info")[0],ipFlagOrigin="https://ipapi.co/static/images/flags",ipField="json";window.onload=loadIP(),inputButton.onclick=(()=>reloadIP()),inputAddress.onkeydown=(e=>{"Enter"!=e.code&&"NumpadEnter"!=e.code||(e.preventDefault(),reloadIP()),"Escape"==e.code&&(e.preventDefault(),inputAddress.blur()),e.stopPropagation()}),ipInfo.ondblclick=(e=>{e.target.closest(".ipaddress__item--text")?copyCell(e.target):document.getSelection().empty(),e.stopPropagation()});{let e;inputForm.addEventListener("focusin",t=>{t.target.hasAttribute("placeholder")&&(e=t.target.placeholder,t.target.placeholder=""),t.stopPropagation()}),inputForm.addEventListener("focusout",t=>{t.target.hasAttribute("placeholder")&&(t.target.placeholder=e),t.stopPropagation()})}